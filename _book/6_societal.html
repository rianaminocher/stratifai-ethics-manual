<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Deliverable 3.2 Ethical plan - 7&nbsp; Societal and Environmental Well-being</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./7_accountability.html" rel="next">
<link href="./5_diversity.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./6_societal.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Societal and Environmental Well-being</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Deliverable 3.2 Ethical plan</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">{.unnumbered .unlisted .hidden}</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Revision History, Status, Abstract, Keywords, Statement of Originality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workshops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Co-creation Workshops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_oversight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Human Agency and Oversight</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_technical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Technical Robustness and Safety</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_privacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Privacy and Data Governance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_transparency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Transparency</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Diversity, Non-discrimination and Fairness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_societal.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Societal and Environmental Well-being</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_accountability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Accountability</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#environmental-wellbeing" id="toc-environmental-wellbeing" class="nav-link active" data-scroll-target="#environmental-wellbeing"><span class="header-section-number">7.1</span> Environmental Wellbeing</a>
  <ul class="collapse">
  <li><a href="#identify-environmental-impact-of-model-development" id="toc-identify-environmental-impact-of-model-development" class="nav-link" data-scroll-target="#identify-environmental-impact-of-model-development"><span class="header-section-number">7.1.1</span> Identify environmental impact of model development</a></li>
  <li><a href="#reduce-environmental-impact" id="toc-reduce-environmental-impact" class="nav-link" data-scroll-target="#reduce-environmental-impact"><span class="header-section-number">7.1.2</span> Reduce environmental impact</a></li>
  </ul></li>
  <li><a href="#impact-on-work-and-skills" id="toc-impact-on-work-and-skills" class="nav-link" data-scroll-target="#impact-on-work-and-skills"><span class="header-section-number">7.2</span> Impact on Work and Skills</a>
  <ul class="collapse">
  <li><a href="#altai-assessment" id="toc-altai-assessment" class="nav-link" data-scroll-target="#altai-assessment">ALTAI Assessment</a></li>
  <li><a href="#investigate-impact-on-work-arrangements" id="toc-investigate-impact-on-work-arrangements" class="nav-link" data-scroll-target="#investigate-impact-on-work-arrangements"><span class="header-section-number">7.2.1</span> Investigate impact on work arrangements</a></li>
  </ul></li>
  <li><a href="#impact-on-society-at-large-or-democracy" id="toc-impact-on-society-at-large-or-democracy" class="nav-link" data-scroll-target="#impact-on-society-at-large-or-democracy"><span class="header-section-number">7.3</span> Impact on Society at large or Democracy</a>
  <ul class="collapse">
  <li><a href="#altai-assessment-1" id="toc-altai-assessment-1" class="nav-link" data-scroll-target="#altai-assessment-1">ALTAI Assessment</a></li>
  <li><a href="#solicit-citizen-feedback" id="toc-solicit-citizen-feedback" class="nav-link" data-scroll-target="#solicit-citizen-feedback"><span class="header-section-number">7.3.1</span> Solicit citizen feedback</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Societal and Environmental Well-being</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The impacts of the AI system on the wellbeing of society must be considered throughout its life cycle. A system which is encountered in aspects of daily life—e.g., healthcare—has the potential to negatively impact mental health and emotional wellbeing. Such effects must be carefully considered and mitigated. Additonally, the sustainability of the AI system under development must be a point of discussion, such that the development and utilization of an AI system benefits all human beings, including future generations. Finally, the system must not undermine democratic processes or pose a threat to democratic society.</p>
<section id="environmental-wellbeing" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="environmental-wellbeing"><span class="header-section-number">7.1</span> Environmental Wellbeing</h2>
<p>AI systems should be as environmentally friendly as possible. The development, deployment and use-processes must therefore be assessed in terms of energy consumption and resource demands, in order to minimize waste. During the development of the STRATIF-AI project, the potential of negative harm on the environment needs to be systematically considered. Measuring the environmental impact through energy consumed and carbon emissions will be built into the development pipeline. Measures to reduce these impacts will be subsequently explored.</p>
<section id="identify-environmental-impact-of-model-development" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="identify-environmental-impact-of-model-development"><span class="header-section-number">7.1.1</span> Identify environmental impact of model development</h3>
<p><strong>Description</strong> The <strong><em>environmental impacts</em></strong> of <strong><em>system development processes</em></strong> need to be measured or estimated by appropriate <strong><em>methodologies</em></strong>.</p>
<p><strong><em>environmental impacts:</em></strong> carbon emissions; energy used;<br>
<strong><em>system development processes</em></strong>: model training; <em>other process with footprint?</em><br>
<strong><em>methodologies:</em></strong> <em>TBD</em></p>
<p><strong>Owner</strong></p>
<ul>
<li>WP2</li>
</ul>
<p><strong>Key Personnel</strong></p>
<ul>
<li>technical staff</li>
</ul>
<p><strong>Schedule</strong> At any point, before end of project.</p>
<p><strong>Stroke Phase</strong> ALL</p>
<p><strong>Actionable tasks</strong></p>
<ul>
<li>appoint key personnel</li>
<li>define parameters (environmental and possibly costly processes)</li>
<li>define method to estimate costs</li>
<li>report costs to consortium/in documentation</li>
</ul>
</section>
<section id="reduce-environmental-impact" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="reduce-environmental-impact"><span class="header-section-number">7.1.2</span> Reduce environmental impact</h3>
<p><strong>Description</strong> A SOP which outlines acceptable <strong><em>thresholds</em></strong> and a resulting process protocol must be developed within an <strong><em>appropriate timeframe</em></strong> to mitigate environmental impacts.</p>
<p><strong><em>thresholds:</em></strong> <em>limit for carbon emissions for model training; limit for time spent model training</em><br>
<strong><em>appropriate timeframe:</em></strong> <em>TBD</em></p>
<p><strong>Owner</strong></p>
<ul>
<li>WP2</li>
</ul>
<p><strong>Key Personnel</strong></p>
<ul>
<li>technical staff</li>
<li>WP3</li>
</ul>
<p><strong>Schedule</strong> At any point, before end of project.</p>
<p><strong>Stroke Phase</strong> ALL</p>
<p><strong>Actionable tasks</strong></p>
<ul>
<li>appoint key personnel</li>
<li>define parameters/ thresholds and procedures</li>
<li>draft SOP (WP3)</li>
<li>develop SOP for modelling team</li>
<li>publish SOP</li>
</ul>
</section>
</section>
<section id="impact-on-work-and-skills" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="impact-on-work-and-skills"><span class="header-section-number">7.2</span> Impact on Work and Skills</h2>
<section id="altai-assessment" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="altai-assessment">ALTAI Assessment</h3>
<p>STRATIF-AI will be designed with a human-in-command governance system and to prioritize the epistemic authority of physicians. However, as a clinical decision-support system, STRATIF-AI will potentially have significant impacts on human work and work arrangements, necessitating a thorough assessment through an implementation strategy. While medical professionals will play a central role in the development pipeline of STRATIF-AI, broader inclusion and consultation with potentially affected workers and their representatives will be carried out. Measures to minimize the system’s impact on human work will be implemented, following an in-depth investigation of STRATIF-AI’s potential risks regarding the de-skilling of doctors or the alteration of training procedures and experiential learning.</p>
</section>
<section id="investigate-impact-on-work-arrangements" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="investigate-impact-on-work-arrangements"><span class="header-section-number">7.2.1</span> Investigate impact on work arrangements</h3>
<p><strong>Description</strong> <strong><em>Methodology</em></strong> to assess <strong><em>concerns</em></strong> of potentially affected <strong><em>workers</em></strong> must be devised to inform the platform’s implementation strategy.</p>
<p><strong><em>methodology:</em></strong> <em>TBD; stakeholder interviews; workshops; focus groups</em><br>
<strong><em>concerns:</em></strong> <em>TBD; de-skilling; mistrust</em><br>
<strong><em>workers:</em></strong> doctors; nurses; insurance personnel; training personnel; rehabilitation specialists; physiotherapists; <em>any affected working persons involved in the care of stroke patients</em></p>
<p><strong>Owner</strong></p>
<ul>
<li>WP3</li>
</ul>
<p><strong>Key Personnel</strong></p>
<ul>
<li>WP4</li>
<li>WP5</li>
<li>WP6</li>
<li>WP7</li>
</ul>
<p><strong>Schedule</strong> At any point, before end of project.</p>
<p><strong>Stroke Phase</strong> EACH (3)</p>
<p><strong>Actionable tasks</strong></p>
<ul>
<li>appoint key personnel</li>
<li>define full set of at-risk workers</li>
<li>conduct workshops with key personnel</li>
<li>design interview to elicit concerns from workers</li>
<li>write process protocol for implementation strategy</li>
<li>feed into HIC concept</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the initial co-creation workshop series, participants expressed concerns that integrating the STRATIF-AI platform into clinical practice too early and without warning may limit the natural experience-building process that physicians generally undergo.</p>
</div>
</div>
</section>
</section>
<section id="impact-on-society-at-large-or-democracy" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="impact-on-society-at-large-or-democracy"><span class="header-section-number">7.3</span> Impact on Society at large or Democracy</h2>
<section id="altai-assessment-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="altai-assessment-1">ALTAI Assessment</h3>
<p>Potential ramifications on society at large and democracy will be considered throughout the STRATIF-AI project cycle. To assess the societal impact of the AI system’s utilization beyond those to immediate end-users and subjects, we will solicit feedback throughout planned pilot and clinical trial studies. A key aspect of the STRATIF-AI platform is developing an infrastructure to empower citizens to monitor their overall health and wellbeing while screening for risk of stroke—which will contribute to the benefit of society at large. The STRATIF-AI platform is not at risk of undermining democratic principles or adversely affecting democracy.</p>
</section>
<section id="solicit-citizen-feedback" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="solicit-citizen-feedback"><span class="header-section-number">7.3.1</span> Solicit citizen feedback</h3>
<p><strong>Description</strong> Include diverse <strong><em>citizens</em></strong> in discussions at relevant <strong><em>stages</em></strong> of the STRATIF-AI pipeline.</p>
<p><strong><em>citizens:</em></strong> citizens; hospital workers; <em>persons who may be overlooked in stakeholder discussions</em><br>
<strong><em>stages:</em></strong> <em>TBD; public representation of STRATIF-AI project; youtube; reddit</em></p>
<p><strong>Owner</strong></p>
<ul>
<li>WP3</li>
</ul>
<p><strong>Key Personnel</strong></p>
<ul>
<li>all WP leads</li>
</ul>
<p><strong>Schedule</strong> At any point, before end of project.</p>
<p><strong>Stroke Phase</strong> ALL</p>
<p><strong>Actionable tasks</strong></p>
<ul>
<li>appoint key personnel/ WP leads</li>
<li>define parameters, i.e.&nbsp;stakeholders who may be overlooked</li>
<li>clarify potential procedures within WP tasks to incorporate discussions</li>
<li>assess input from stakeholders</li>
<li>disseminate information</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./5_diversity.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Diversity, Non-discrimination and Fairness</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./7_accountability.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Accountability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>